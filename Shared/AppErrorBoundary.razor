@using Microsoft.AspNetCore.Components.Web
@inherits ErrorBoundaryBase

@if (CurrentException is not null)
{
    <MudAlert Severity="Severity.Error" Variant="Variant.Filled" Class="my-4">
        <MudStack Spacing="2">
            <MudText Typo="Typo.h6">@Title</MudText>
            <MudText Typo="Typo.body2">@Message</MudText>
            @if (ShowDetails && !string.IsNullOrEmpty(CurrentException.Message))
            {
                <MudText Typo="Typo.caption" Class="mt-2">
                    @CurrentException.Message
                </MudText>
            }
            <MudButton Variant="Variant.Outlined" Color="Color.Error"
                       OnClick="Recover" Size="Size.Small">
                @RecoverButtonText
            </MudButton>
        </MudStack>
    </MudAlert>
}
else
{
    @ChildContent
}

@code {
    [Parameter] public string Title { get; set; } = "An error occurred";
    [Parameter] public string Message { get; set; } = "We're sorry, something went wrong.";
    [Parameter] public string RecoverButtonText { get; set; } = "Try Again";
    [Parameter] public bool ShowDetails { get; set; }

    private new void Recover()
    {
        base.Recover();
    }

    protected override Task OnErrorAsync(Exception exception)
    {
        Console.WriteLine($"Error caught by boundary: {exception.Message}");
        return Task.CompletedTask;
    }
}
